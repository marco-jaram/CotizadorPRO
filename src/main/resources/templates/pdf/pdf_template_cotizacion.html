<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Cotización</title>
    <style type="text/css">
        body { font-family: 'Helvetica', sans-serif; font-size: 10px; color: #333; }
        @page {
            size: A4;
            margin: 1.5cm;
            @bottom-center {
                content: "Página " counter(page) " de " counter(pages);
                font-size: 9px;
            }
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #0056b3;
        }
        .company-logo img { max-width: 150px; max-height: 80px; }
        .quote-title { text-align: right; }
        .quote-title h1 { margin: 0; color: #0056b3; font-size: 24px; }
        .quote-title p { margin: 2px 0; }
        .info-section { display: flex; justify-content: space-between; margin-bottom: 20px; }
        .info-box { width: 48%; background-color: #f8f9fa; padding: 10px; border: 1px solid #dee2e6; border-radius: 5px; }
        .info-box h5 { margin-top: 0; border-bottom: 1px solid #ccc; padding-bottom: 5px; }
        .info-box ul { list-style: none; padding-left: 0; margin-bottom: 0; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        thead { background-color: #0056b3; color: white; }
        .text-right { text-align: right; }
        .totals-section {
            float: right;
            width: 40%;
        }
        .totals-section table {
            width: 100%;
            border: none;
        }
        .totals-section td {
            border: none;
            padding: 4px 8px;
        }
        .totals-section .total-row {
            font-weight: bold;
            background-color: #f2f2f2;
            border-top: 2px solid #333;
        }
        .footer {
            position: fixed;
            bottom: -1cm; /* Ajustar según márgenes */
            left: 0;
            right: 0;
            text-align: center;
            font-size: 9px;
            color: #777;
            border-top: 1px solid #ccc;
            padding-top: 5px;
        }
    </style>
</head>
<body>

<div class="header">
    <div class="company-logo">
        <img th:if="${logoBase64 != ''}" th:src="${logoBase64}" alt="Logo de la Empresa"/>
        <h3 th:unless="${logoBase64 != ''}" th:text="${cotizacion.vendedor.nombreEmpresa}"></h3>
    </div>
    <div class="quote-title">
        <h1>COTIZACIÓN</h1>
        <p><strong>Folio:</strong> <span th:text="${cotizacion.folio}"></span></p>
        <p><strong>Fecha:</strong> <span th:text="${#temporals.format(cotizacion.fechaEmision, 'dd/MM/yyyy')}"></span></p>
        <p><strong>Vigencia:</strong> <span th:text="${cotizacion.vigencia}"></span></p>
    </div>
</div>

<div class="info-section">
    <div class="info-box">
        <h5>VENDEDOR:</h5>
        <ul>
            <li th:text="${cotizacion.vendedor.nombreEmpresa}"></li>
            <li th:text="${cotizacion.vendedor.direccion}"></li>
            <li th:text="${cotizacion.vendedor.correo}"></li>
            <li th:text="${cotizacion.vendedor.telefono}"></li>
        </ul>
    </div>
    <div class="info-box">
        <h5>CLIENTE:</h5>
        <ul>
            <li th:text="${cotizacion.cliente.nombreEmpresa}"></li>
            <li th:text="${cotizacion.cliente.direccion}"></li>
            <li th:text="${cotizacion.cliente.correo}"></li>
            <li th:text="${cotizacion.cliente.telefono}"></li>
        </ul>
    </div>
</div>

<!-- Tabla de Conceptos/Productos -->
<table>
    <thead>
    <tr>
        <th th:text="${cotizacion instanceof T(com.tuempresa.cotizador.web.dto.CotizacionServiciosDTO)} ? 'Concepto' : 'Producto'"></th>
        <th class="text-right">Cantidad</th>
        <th>Unidad</th>
        <th class="text-right">Precio Unit.</th>
        <th class="text-right">Subtotal</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="linea : ${cotizacion.lineas}">
        <td th:text="${cotizacion instanceof T(com.tuempresa.cotizador.web.dto.CotizacionServiciosDTO)} ? ${linea.concepto} : ${linea.productoNombre}"></td>
        <td class="text-right" th:text="${#numbers.formatDecimal(linea.cantidad, 1, 'COMMA', 2, 'POINT')}"></td>
        <td th:text="${linea.unidad}"></td>
        <td class="text-right" th:text="${#numbers.formatCurrency(linea.precioUnitario)}"></td>
        <td class="text-right" th:text="${#numbers.formatCurrency(linea.subtotal)}"></td>
    </tr>
    </tbody>
</table>

<div class="totals-section">
    <table>
        <tr>
            <td>Subtotal:</td>
            <td class="text-right" th:text="${#numbers.formatCurrency(subtotal)}"></td>
        </tr>
        <tr>
            <td>IVA (16%):</td>
            <td class="text-right" th:text="${#numbers.formatCurrency(iva)}"></td>
        </tr>
        <tr class="total-row">
            <td>TOTAL:</td>
            <td class="text-right" th:text="${#numbers.formatCurrency(totalConIva)}"></td>
        </tr>
    </table>
</div>

<div class="footer">
    <p th:text="${cotizacion.vendedor.nombreEmpresa} + ' - ' + ${cotizacion.vendedor.sitioWeb}"></p>
    <p>Gracias por su preferencia.</p>
</div>

</body>
</html>